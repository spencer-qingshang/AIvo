# 任务规格说明书：英语学习笔记体系重构 (English Learning Vault Refactor)

## 1. 概述 (Overview)
本任务旨在重构 Obsidian 库中现有的英语学习笔记体系。目前的系统存在检索困难、格式不统一、层级混乱等问题。我们将建立一个由模板驱动的标准化系统，利用 Obsidian Dataview 插件实现自动化索引和可视化导航，并以《摩登家庭》和 PETS-3 练习作为首批迁移试点。

## 2. 功能需求 (Functional Requirements)

### 2.1 目录与层级重构
- **目标：** 扁平化目录结构，规范命名，从“文件夹分类”转向“标签+属性分类”。
- **新结构提案 (位于 C4=归档资料/4.1=学习类/4.1.1=英语学习/)：**
  - `00=仪表盘`：中央入口。
  - `10=学习素材`：原始素材（如摩登家庭剧本、真题文章），按 ID 组织。
  - `20=知识库`：原子化笔记（单词、语法规则）。
  - `30=复盘`：每日日志、错题记录、练习输出。
  - `40=考试`：PETS-3、自考英语大纲及模拟题。
  - `99=归档`：旧版笔记。
  - `模板`：存放标准 Markdown 模板。

### 2.2 标准化模板 (Templates)
- 在 `模板/` 文件夹下创建以下标准 Markdown 模板：
  - **素材模板**：用于剧集、文章。属性包含：`type: source`, `status`, `tags`, `level`。
  - **单词模板**：用于单个单词。属性包含：`type: vocab`, `definitions`, `examples`, `mastery`（掌握度）。
  - **语法模板**：用于语法点。属性包含：`type: grammar`, `difficulty`。
  - **复盘模板**：用于每日总结。属性包含：`type: review`, `date`, `rating`。
  - **错题模板**：用于记录特定错误。属性包含：`type: error`, `related_source`, `reason`。

### 2.3 自动化与仪表盘 (Dataview)
- **主仪表盘 (`英语学习主页.md`)：**
  - **当前活跃任务**：显示 `plan.md` 中的未完成任务或状态为“学习中”的素材。
  - **复习队列**：利用 Dataview 自动列出需要复习的单词和语法点。
  - **统计信息**：本周新增单词数、累计学习时长。
- **动态视图：**
  - **错题库**：自动汇总所有 `type: error` 的笔记，按错误类型（如 #语法、#拼写）分组。
  - **生词本**：自动生成的表格，按添加时间或字母顺序排列所有生词。

### 2.4 迁移脚本 (Migration)
- 开发 Python 脚本 (`scripts/migrate_notes.py`)：
  - 解析现有的 `重点词汇与答疑笔记.md` 和 `每日学习进度表.md`。
  - 提取其中的生词和错题。
  - 根据新模板批量生成原子化笔记。
  - 将《摩登家庭》S01E01 和 PETS-3 2015年9月的内容迁移至新结构。

## 3. 非功能需求 (Non-Functional Requirements)
- **兼容性**：必须完美兼容 Obsidian 移动端和桌面端。
- **性能**：Dataview 查询应进行优化，确保不影响库的加载速度。
- **扩展性**：结构必须支持未来增加新科目（如《老友记》、CET-4）而无需更改根目录。

## 4. 验收标准 (Acceptance Criteria)
- [ ] 创建了新的目录结构并填充了 `Templates` 文件夹。
- [ ] 至少创建并测试了 4 个核心模板（素材、单词、复盘、错题）。
- [ ] 创建了 `英语学习主页.md` 并能成功查询并显示动态数据。
- [ ] 《摩登家庭》S01E01 的笔记成功迁移至新格式。
- [ ] PETS-3 2015年9月的笔记成功迁移至新格式。
- [ ] 关键旧笔记已迁移，非核心旧笔记已移至 `99_Archive`。

## 5. 不包含范围 (Out of Scope)
- 全量迁移与当前学习无关的所有历史文件（如 2023 年的日记）。
- 与 Anki 的自动化同步（保留作为未来任务）。
- 发音相关的特定功能。
