# 项目4_2_IPv6静态与默认路由实战 (零基础保姆级)

> **实验目标**：通过手动配置 IPv6 静态路由，让北京的 PC1 能够 Ping 通广州的 PC2。
> **适用场景**：小型网络，或者需要精确控制路径的场景。

---

## 一、 知识点大白话解析

> **1. 什么是 IPv6 静态路由？**
> 跟 IPv4 一样，它就是管理员手动在路由器上贴的“路标”。比如告诉 R1：“要去 2001:2:: 网段（广州），请把包交给 R2”。
>
> **2. 为什么要用“链路本地地址” (FE80::) 做下一跳？**
> 在 IPv6 静态路由中，我们通常不写对方的全球地址（2001::），而是写对方接口的 `FE80::` 地址。
> **理由**：链路本地地址是自动生成的，非常稳定。即使对方以后换了全球 IP 宽带，只要物理线没动，你的路由就永远有效，不需要改。
>
> **3. 什么是默认路由 `:: 0`？**
> 它相当于 IPv4 的 `0.0.0.0 0`。`::` 代表全 0，`0` 代表掩码长度为 0。意思就是：“不管去哪，统统往这里扔”。

---

## 二、 环境准备
本实验基于 **项目 4_1** 的拓扑和 IP 配置。请确保：
1.  三台路由器 R1, R2, R3 已按 4_1 的要求配置好各接口的全球单播地址。
2.  PC1 和 PC2 已经配好了 IP 和网关。
3.  **测试**：PC1 此时应该能 Ping 通 R1 的网关，但 **Ping 不通** PC2。

---

## 三、 核心配置步骤 (手动指路)

### 1. 给 R1 指路 (北京去广州)
R1 此时只知道 1.0 和 12.0 网段。我们需要告诉它：想去 PC2 所在的 `2001:2::` 网段，请交给 R2。

```shell
<R1> system-view
# 格式：ipv6 route-static [目标网段] [掩码] [下一跳地址]
[R1] ipv6 route-static 2001:2:: 64 2001:12::2
```
*注：这里为了教学方便使用了全球地址做下一跳。实战中也可以用 R2 的 FE80 地址。*

### 2. 给 R2 指路 (中间人要指两头)
R2 必须知道怎么去北京，也得知道怎么去广州。
```shell
<R2> system-view
[R2] ipv6 route-static 2001:1:: 64 2001:12::1   # 去北京找 R1
[R2] ipv6 route-static 2001:2:: 64 2001:23::3   # 去广州找 R3
```

### 3. 给 R3 指路 (回程路由必不可少)
通信是双向的。包能过去，回不来也是不通。
```shell
<R3> system-view
[R3] ipv6 route-static 2001:1:: 64 2001:23::2   # 回北京找 R2
```

---

## 四、 默认路由配置 (进阶)
> **任务**：假设 R1 是公司出口，我们可以用默认路由简化配置。

如果 R1 不想写那么多条静态路由，可以只写一条默认路由：
```shell
[R1] undo ipv6 route-static 2001:2:: 64 2001:12::2  # 先删掉刚才那条
[R1] ipv6 route-static :: 0 2001:12::2             # 只要不认识的，统统扔给R2
```

---

## 五、 验证与检查 (见证奇迹)

### 1. 查看 IPv6 路由表
在 R1 上输入：
`display ipv6 routing-table`

*   **看什么？**：检查 `Destination` 中是否有 `2001:2::/64`，其 `Protocol` 应该是 `Static`。

### 2. 最终 Ping 测试
打开 **PC1** 的命令行：
`ping 2001:2::1` (这是 PC2 的地址)

*   **预期结果**：如果看到 `Reply from ...`，恭喜你，IPv6 静态路由配置成功！

---

## 六、 新手避坑指南 (常见报错)

1.  **Ping 还是不通？**
    *   **检查回程**：一定要去 R3 上查一下有没有回 2001:1:: 的路由。新手最容易忘掉回程路由。
    *   **检查掩码**：IPv6 掩码通常是 `64`。如果你写成了 `24`（那是 IPv4 的习惯），会导致路由计算错误。
2.  **下一跳写谁？**
    *   下一跳必须是和你**直接连着的那台路由器**的接口 IP。不能跨过 R2 直接写 R3。