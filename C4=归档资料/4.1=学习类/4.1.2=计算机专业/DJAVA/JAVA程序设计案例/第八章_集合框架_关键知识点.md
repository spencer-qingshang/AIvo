# 第八章：集合框架 - 必备关键知识点

本章主要涵盖 Java 集合框架的基础概念、常用接口（Collection, List, Set, Map）及其核心实现类，以及Collections工具类和比较器接口。

---

## 1. 集合框架体系概览

*   **Collection**：单列集合的根接口，存储一系列独立元素。
    *   **List** 接口：
        *   **特点**：**有序**（元素有索引，存取顺序一致）、**可重复**。
        *   **常用实现类**：`ArrayList` (基于动态数组，查询快，增删慢)、`LinkedList` (基于链表，增删快，查询慢)。
    *   **Set** 接口：
        *   **特点**：**无序**（不保证存取顺序）、**不可重复**（元素唯一）。
        *   **常用实现类**：`HashSet` (基于哈希表，性能高)、`TreeSet` (基于红黑树，元素有序)。
*   **Map** 接口：
    *   **特点**：**双列集合**，存储**键值对** (`<Key, Value>`)。
    *   **Key** 必须**唯一**，**Value** 可以重复。
    *   **不继承** `Collection` 接口，是独立的顶层接口。
    *   **常用实现类**：`HashMap` (基于哈希表，无序，键唯一)、`TreeMap` (基于红黑树，键有序)。

---

## 2. Collection 接口常用方法 (单列集合通用)

| 操作类型 | 方法名                   | 描述                                 |
| :------- | :----------------------- | :----------------------------------- |
| 添加     | `boolean add(E e)`       | 添加单个元素                         |
|          | `boolean addAll(Collection<? extends E> c)` | 添加另一个集合的所有元素             |
| 删除     | `boolean remove(Object o)` | 删除指定元素（只删第一个匹配的）     |
|          | `void clear()`           | 清空集合                             |
| 判断     | `boolean contains(Object o)` | 判断是否包含某元素 (依赖 `equals` 方法) |
|          | `boolean isEmpty()`      | 判断集合是否为空                     |
| 获取     | `int size()`             | 获取元素个数                         |
| 转换     | `Object[] toArray()`     | 转换为数组                           |

---

## 3. List 接口的深入理解

*   **List 特有操作 (通过索引)**：
    *   `list.add(int index, E element)`：在指定索引插入元素。
    *   `E list.get(int index)`：获取指定索引的元素。
    *   `E list.set(int index, E element)`：修改指定索引的元素。
    *   `E list.remove(int index)`：删除指定索引的元素。
*   **泛型 (`<T>` 或 `<E>`)**：
    *   **作用**：在编译阶段约束集合中存储的数据类型。
    *   **好处**：避免`ClassCastException`，取出元素时无需强制类型转换。
    *   **示例**：`List<String> list` 只能存储字符串。
*   **遍历方式**：
    *   **`Iterator` (迭代器)**：集合遍历的标准方式。
        *   `Iterator<E> it = list.iterator();`
        *   `while(it.hasNext()) { E element = it.next(); ... }`
        *   **注意**：在遍历过程中删除元素，必须使用 `it.remove()`，不能用 `list.remove()`。
    *   **`foreach` (增强for循环)**：
        *   `for (E element : list) { ... }`
        *   适用于只需读取元素，不操作索引或删除的场景。
    *   **普通 `for` 循环**：`for (int i = 0; i < list.size(); i++) { list.get(i); }` (利用索引)。

---

## 4. Set 接口的深入理解

*   **Set 核心特点**：**无序**、**不可重复**。
*   **Set 作用**：最主要的功能是用于**去重**。
*   **注意**：`Set` 没有索引，**不能**使用 `get(i)` 方法和普通 `for` 循环遍历。
*   **`HashSet` 与 `TreeSet` 异同**：
    | 特性     | `HashSet`            | `TreeSet`                      |
    | :------- | :------------------- | :----------------------------- |
    | **底层结构** | 哈希表               | 红黑树                         |
    | **有序性** | 无序（不保证存取顺序） | 排序（默认升序或自定义排序）   |
    | **性能** | 增删查性能极高 (O(1)) | 较慢 (O(log n)，需维护排序)    |
    | **Null值** | 允许存一个 `null`    | 不允许存 `null`                |
    | **去重依据** | `hashCode()` 和 `equals()` | `compareTo()` (或 `Comparator`) |
    | **场景** | 只需要去重，不在乎顺序 | 需要去重，且需要对结果进行排序 |
*   **元素修改**：`Set` 没有直接修改元素的方法，通过“先删后加”实现。

---

## 5. Map 接口的深入理解

*   **Map 核心特点**：存储**键值对** `<K, V>`。`Key` 唯一，`Value` 可重复。
*   **`HashMap`**：`Map`接口最常用的实现类。**无序**，键不允许重复（新值覆盖旧值），允许 `null` 键和 `null` 值。
*   **Map 常用方法**：
    *   **添加/修改**：`V put(K key, V value)` (键不存在则添加，存在则覆盖并返回旧值)。
    *   **删除**：`V remove(Object key)` (根据键删除，返回被删除的值)。
    *   **查询**：`V get(Object key)` (根据键获取值，键不存在返回`null`)。
    *   **判断**：`boolean containsKey(Object key)` (高效判断键是否存在)。
    *   **获取视图**：`Set<K> keySet()` (获取所有键的集合)。`Collection<V> values()` (获取所有值的集合)。`Set<Map.Entry<K,V>> entrySet()` (获取所有键值对对象的集合)。
*   **Map 遍历方式**：
    *   **方式一：键找值 (KeySet)**：先获取所有键，再通过`get(key)`获取值。
        ```java
        for (String key : map.keySet()) {
            Integer value = map.get(key);
            System.out.println(key + " = " + value);
        }
        ```
    *   **方式二：键值对对象 (EntrySet)**：直接获取键值对对象(`Map.Entry`)，效率更高。
        ```java
        for (Map.Entry<String, Integer> entry : map.entrySet()) {
            String k = entry.getKey();
            Integer v = entry.getValue();
            System.out.println(k + " = " + v);
        }
        ```

---

## 6. Collections 工具类与比较接口

*   **`Collections` 类 (`java.util.Collections`)**：
    *   **概念**：是操作集合的**工具类**（注意与`Collection`接口区分）。
    *   **常用方法**：
        *   `public static void sort(List<T> list)`：对`List`进行升序排序（依赖元素的自然排序，即元素类需实现`Comparable`接口）。
        *   `public static void sort(List<T> list, Comparator<? super T> c)`：根据指定的比较器对`List`进行排序（定制排序）。
        *   `shuffle(List<?> list)`：打乱集合顺序。
        *   `reverse(List<?> list)`：反转集合顺序。
*   **`Comparable` 接口 (`java.lang.Comparable`)**：
    *   **角色**：**内部比较器**。由元素类自己实现，定义对象的**默认排序规则**（自然排序）。
    *   **核心方法**：`int compareTo(T o)`。
    *   **返回值约定**：`this`对象小于`o`返回负数，等于返回0，大于返回正数。
*   **`Comparator` 接口 (`java.util.Comparator`)**：
    *   **角色**：**外部比较器**。单独定义一个类或匿名内部类来实现，用于临时改变排序规则，或对无法修改源码的类进行排序。
    *   **核心方法**：`int compare(T o1, T o2)`。
    *   **返回值约定**：`o1`小于`o2`返回负数，等于返回0，大于返回正数。

---
