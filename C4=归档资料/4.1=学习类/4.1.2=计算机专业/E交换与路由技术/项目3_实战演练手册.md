# 项目3：实战演练手册 (保姆级)

## 实验目标
从零开始，搭建一个由3台路由器组成的网络，让最左边的电脑能Ping通最右边的电脑。

## 实验场景 (拓扑图想象)
想象三个城市：北京、上海、广州。
*   **PC1** (北京用户)
*   **R1** (北京路由器)
*   **R2** (上海路由器 - 中转站)
*   **R3** (广州路由器)
*   **PC2** (广州用户)

连接方式：
`PC1` <---> `R1` <---> `R2` <---> `R3` <---> `PC2`

---

## 第一阶段：搭建与基础配置

### 1. 摆放设备
1.  打开eNSP。
2.  拖出 **3台 AR2220 路由器**，分别命名为 R1, R2, R3。
3.  拖出 **2台 PC**，命名为 PC1, PC2。
4.  **连线 (使用Auto自动连线)**：
    *   PC1 连 R1 (GE0/0/1)
    *   R1 (GE0/0/0) 连 R2 (GE0/0/0)
    *   R2 (GE0/0/1) 连 R3 (GE0/0/0)
    *   R3 (GE0/0/1) 连 PC2
5.  **启动所有设备**。

### 2. 规划IP地址 (这一步最重要！)
网络如果不规划，后面绝对乱。我们约定：
*   **PC1所在网段**：192.168.10.0/24 (网关 .254)
*   **R1-R2之间**：12.1.1.0/24 (R1用.1, R2用.2)
*   **R2-R3之间**：23.1.1.0/24 (R2用.2, R3用.3)
*   **PC2所在网段**：192.168.20.0/24 (网关 .254)

### 3. 配置PC的IP
双击PC图标 -> `基础配置`：
*   **PC1**:
    *   IP: 192.168.10.1
    *   掩码: 255.255.255.0
    *   **网关**: 192.168.10.254 (切记！没网关出不去)
*   **PC2**:
    *   IP: 192.168.20.1
    *   掩码: 255.255.255.0
    *   **网关**: 192.168.20.254

### 4. 配置路由器接口IP (从左到右)

**配置 R1:**
```shell
<Huawei> sys
[Huawei] sysname R1
[R1] int g0/0/1                  # 连接PC的口
[R1-GigabitEthernet0/0/1] ip add 192.168.10.254 24
[R1-GigabitEthernet0/0/1] int g0/0/0                  # 连接R2的口
[R1-GigabitEthernet0/0/0] ip add 12.1.1.1 24
```

**配置 R2:**
```shell
<Huawei> sys
[Huawei] sysname R2
[R2] int g0/0/0                  # 连接R1的口
[R2-GigabitEthernet0/0/0] ip add 12.1.1.2 24
[R2-GigabitEthernet0/0/0] int g0/0/1                  # 连接R3的口
[R2-GigabitEthernet0/0/1] ip add 23.1.1.2 24
```

**配置 R3:**
```shell
<Huawei> sys
[Huawei] sysname R3
[R3] int g0/0/0                  # 连接R2的口
[R3-GigabitEthernet0/0/0] ip add 23.1.1.3 24
[R3-GigabitEthernet0/0/0] int g0/0/1                  # 连接PC的口
[R3-GigabitEthernet0/0/1] ip add 192.168.20.254 24
```

---

## 第二阶段：尝试Ping (此时是不通的)
用 PC1 去 ping PC2 (192.168.20.1)。
*   **结果**：`Destination host unreachable` (目标主机不可达)。
*   **原因**：R1只知道自己的直连网段，它根本不知道 192.168.20.0 在哪，所以直接把包丢了。

---

## 第三阶段：配置静态路由 (告诉它们怎么走)

我们需要给每个路由器指路。

**1. R1 (北京) 怎么去 R3 (广州)？**
R1说：我要去 192.168.20.0，下一站给 R2 (12.1.1.2)。
```shell
[R1] ip route-static 192.168.20.0 24 12.1.1.2
```

**2. R2 (上海) 的路由**
R2在中间，它左边要去北京，右边要去广州，所以它要两条路。
```shell
[R2] ip route-static 192.168.10.0 24 12.1.1.1   # 去找PC1，给R1
[R2] ip route-static 192.168.20.0 24 23.1.1.3   # 去找PC2，给R3
```

**3. R3 (广州) 怎么回 R1 (北京)？**
通信是双向的！PC1的数据包能到PC2，但PC2的回信如果找不到路，还是通不了。
R3说：我要去 192.168.10.0，下一站给 R2 (23.1.1.2)。
```shell
[R3] ip route-static 192.168.10.0 24 23.1.1.2
```

---

## 第四阶段：验证与测试
再次用 PC1 Ping PC2。
*   **期待结果**：`Reply from 192.168.20.1: bytes=32 ...`
*   **成功！**

---

## 进阶挑战：换成 OSPF (自动导航)
如果你想体验“高科技”，先把刚才配的静态路由全删了（在命令前加 `undo`），然后用OSPF。

**配置 R1 的OSPF:**
```shell
[R1] ospf 1
[R1-ospf-1] area 0
[R1-ospf-1-area-0.0.0.0] network 192.168.10.0 0.0.0.255   # 宣告我的左手
[R1-ospf-1-area-0.0.0.0] network 12.1.1.0 0.0.0.255       # 宣告我的右手
```
*R2 和 R3 同理，把它们身上的所有网段都 network 进去。你会看到控制台弹出 `FULL` 的提示，说明它们自动连上了。*
