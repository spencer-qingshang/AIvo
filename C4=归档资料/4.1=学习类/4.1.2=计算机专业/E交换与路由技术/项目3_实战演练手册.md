# 项目3：路由器实战演练手册 (静态路由 + OSPF)

> **核心目标**：通过3台路由器连接两台PC，分别使用“静态路由”和“OSPF”实现全网互通。
> **适用场景**：eNSP模拟器，AR2220路由器。

---

## 一、 环境搭建 (避坑必读)

### 1. 物理拓扑
**严禁使用 Auto 自动连线！** 请使用 `Copper` (铜轴线) 手动连接，确保端口一一对应。

| 起点 | 接口 | ----> | 终点 | 接口 | 说明 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **PC1** | Eth 0/0/1 | --> | **R1** | **GE 0/0/1** | 北京用户接入 |
| **R1** | **GE 0/0/0** | --> | **R2** | **GE 0/0/0** | R1-R2 骨干互联 |
| **R2** | **GE 0/0/1** | --> | **R3** | **GE 0/0/0** | R2-R3 骨干互联 |
| **R3** | **GE 0/0/1** | --> | **PC2** | Eth 0/0/1 | 广州用户接入 |

### 2. IP地址规划
*   **PC1 网段**: 192.168.10.0/24 (网关 .254)
*   **R1-R2 互联**: 12.1.1.0/24 (R1用.1, R2用.2)
*   **R2-R3 互联**: 23.1.1.0/24 (R2用.2, R3用.3)
*   **PC2 网段**: 192.168.20.0/24 (网关 .254)

---

## 二、 基础配置 (地基)

### 1. PC端设置
*   **PC1**: IP `192.168.10.1`, 掩码 `255.255.255.0`, 网关 `192.168.10.254`。
*   **PC2**: IP `192.168.20.1`, 掩码 `255.255.255.0`, 网关 `192.168.20.254`。

### 2. 路由器接口IP配置
```shell
# R1 配置
[R1] interface g0/0/1
[R1-g0/0/1] ip address 192.168.10.254 24
[R1-g0/0/1] interface g0/0/0
[R1-g0/0/0] ip address 12.1.1.1 24

# R2 配置
[R2] interface g0/0/0
[R2-g0/0/0] ip address 12.1.1.2 24
[R2-g0/0/0] interface g0/0/1
[R2-g0/0/1] ip address 23.1.1.2 24

# R3 配置
[R3] interface g0/0/0
[R3-g0/0/0] ip address 23.1.1.3 24
[R3-g0/0/0] interface g0/0/1
[R3-g0/0/1] ip address 192.168.20.254 24
```

---

## 三、 实战一：静态路由 (手工指路)

### 1. 命令实现
```shell
# R1
[R1] ip route-static 192.168.20.0 24 12.1.1.2

# R2
[R2] ip route-static 192.168.10.0 24 12.1.1.1
[R2] ip route-static 192.168.20.0 24 23.1.1.3

# R3
[R3] ip route-static 192.168.10.0 24 23.1.1.2
```

---

## 四、 实战二：从静态路由切换到 OSPF

### 1. 清理静态路由
```shell
[R1] undo ip route-static 192.168.20.0 24 12.1.1.2
# R2, R3 同理，使用 undo 命令删掉之前配的静态路由
```

### 2. OSPF 配置
```shell
# R1 配置
[R1] ospf 1 router-id 1.1.1.1
[R1-ospf-1] area 0
[R1-ospf-1-area-0.0.0.0] network 192.168.10.0 0.0.0.255
[R1-ospf-1-area-0.0.0.0] network 12.1.1.0 0.0.0.255

# R2 配置
[R2] ospf 1 router-id 2.2.2.2
[R2-ospf-1] area 0
[R2-ospf-1-area-0.0.0.0] network 12.1.1.0 0.0.0.255
[R2-ospf-1-area-0.0.0.0] network 23.1.1.0 0.0.0.255

# R3 配置
[R3] ospf 1 router-id 3.3.3.3
[R3-ospf-1] area 0
[R3-ospf-1-area-0.0.0.0] network 23.1.1.0 0.0.0.255
[R3-ospf-1-area-0.0.0.0] network 192.168.20.0 0.0.0.255
```