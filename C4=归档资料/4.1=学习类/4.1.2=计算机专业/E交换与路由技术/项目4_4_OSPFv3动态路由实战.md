# 项目4_4：OSPFv3 动态路由实战 (小白保姆级教程)

> **实验目标**：在大型 IPv6 网络中开启 OSPFv3 协议，实现快速、稳定的全网自动指路。
> **适用场景**：中大型企业园区网，IPv6 环境。

---

## 一、 生活化比喻：智能卫星地图导航

如果 RIPng 是“村口大喇叭”，那 OSPFv3 就是“实时更新的卫星地图”。
*   **OSPFv3 的逻辑**：每个路由器都不是只听邻居喊，而是通过卫星（LSA 报文）把整个地图的路线都下载下来。
*   **最短路径 (SPF)**：它能计算出最快、最不堵的那条路，而不仅仅是数路口。
*   **v3 的含义**：OSPF 第 1 版是实验，第 2 版跑 IPv4，第 3 版专门给 IPv6 用。

---

## 二、 核心配置步骤

### 1. 搭建环境
*   连接 3 台路由器（R1-R2-R3）。
*   确保所有接口已配好 IPv6 地址并已 `ipv6 enable`。

### 2. 必须步骤：手动起名字 (Router-ID)
**注意**：OSPFv3 虽然跑在 IPv6 上，但它的身份证号（Router-ID）依然要长得像 IPv4 地址（如 1.1.1.1）。华为设备通常需要手动指定。
```shell
<R1> system-view
[R1] ospfv3 1                     # 【命令拆解】开启 OSPFv3 进程 1
[R1-ospfv3-1] router-id 1.1.1.1   # 【必做】给路由器起个唯一代号，长得像 IP 但不是 IP。
[R1-ospfv3-1] quit
```

### 3. 在接口下“绑定区域” (重点！)
OSPFv3 同样不在全局宣告，而是直接去接口下“签到”。
```shell
[R1] interface GigabitEthernet 0/0/0
[R1-GigabitEthernet0/0/0] ospfv3 1 area 0   # 【拆解】告诉 0/0/0 接口：加入 1 号 OSPF 进程的 0 号区域（骨干区）。

[R1] interface GigabitEthernet 0/0/1
[R1-GigabitEthernet0/0/1] ospfv3 1 area 0   # 同样，所有要通网的接口都要敲。
```
*请在 R2 和 R3 上重复上述步骤，R2 设 ID 为 2.2.2.2，R3 设 ID 为 3.3.3.3。*

---

## 三、 避坑必杀技 (新手必看)

1.  **忘记配 Router-ID**：
    *   **这是新手最大的坑**。如果你不手动敲 `router-id`，OSPFv3 进程可能根本起不来，或者状态一直是 `down`。
2.  **区域 (Area) 不匹配**：
    *   邻居两端的接口必须在同一个区域（比如都是 area 0）。如果一端是 0 一端是 1，它们会互相不理睬。
3.  **忘记全局开启 IPv6**：
    *   虽然在配 OSPFv3，但底层的全局 `ipv6` 命令必须先敲过。

---

## 四、 实验自测 (检查方法)

在 R1 命令行输入：
`display ospfv3 peer`

*   **预期结果**：
    *   你应该能看到邻居的状态变成了 **Full**。
    *   **Full** 意味着它们已经交换完地图，完全同步了。
*   **查看成果**：
    *   `display ipv6 routing-table protocol ospfv3`
    *   如果你能看到去往远程网段的路由，恭喜你，你已经掌握了最现代的动态路由技术！

---

## 五、 总结 (笔记)
*   OSPFv3 三步走：1. 全局进程；2. 手动 Router-ID；3. 接口绑定区域。
*   优势：收敛快、支持大网络、计算更科学。
*   注意：Router-ID 必须手动指定，且格式必须是 `x.x.x.x`。
