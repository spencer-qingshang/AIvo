# 项目6-3：防火墙基础实战手册

> **核心目标**：划分 Trust 和 Untrust 区域，配置安全策略允许内网访问外网。
> **场景**：USG6000V 防火墙作为边界网关。

---

## 一、 环境准备

### 1. eNSP 拓扑
*   **FW1**: USG6000V 防火墙（默认用户名 admin，密码 Admin@123）。
*   **PC1**: 内网用户 (Trust)。
*   **Server1**: 外网服务器 (Untrust)。

### 2. 规划表
| 区域 | 接口 | IP地址 | 说明 |
| :--- | :--- | :--- | :--- |
| **Trust** | G1/0/1 | 192.168.1.1/24 | 内网接口 |
| **Untrust** | G1/0/2 | 202.100.1.1/24 | 外网接口 |

---

## 二、 基础配置 (划地盘)

### 1. 配置接口 IP
```shell
[FW1] interface g1/0/1
[FW1-GigabitEthernet1/0/1] ip address 192.168.1.1 24
[FW1-GigabitEthernet1/0/1] quit
[FW1] interface g1/0/2
[FW1-GigabitEthernet1/0/2] ip address 202.100.1.1 24
```

### 2. 将接口加入安全区域 (Zone)
```shell
[FW1] firewall zone trust
[FW1-zone-trust] add interface g1/0/1
# 大白话：G1/0/1 接口后面连接的是“自己人”，加入 Trust 区域。
[FW1-zone-trust] quit

[FW1] firewall zone untrust
[FW1-zone-untrust] add interface g1/0/2
# 大白话：G1/0/2 接口后面是“外人”，加入 Untrust 区域。
[FW1-zone-untrust] quit
```

---

## 三、 安全策略 (发通行证)

### 1. 配置策略：允许 Trust 访问 Untrust
```shell
[FW1] security-policy
[FW1-policy-security] rule name trust_to_untrust
# 大白话：新建一条规则，名字叫“允许内网出外网”。
[FW1-policy-security-rule-trust_to_untrust] source-zone trust
# 大白话：来源是 Trust 区域。
[FW1-policy-security-rule-trust_to_untrust] destination-zone untrust
# 大白话：目的地是 Untrust 区域。
[FW1-policy-security-rule-trust_to_untrust] action permit
# 大白话：动作是“放行” (Permit)。
[FW1-policy-security-rule-trust_to_untrust] quit
```

### 2. 坑点提示
*   华为防火墙默认**拒绝所有流量**。如果你不配这条策略，PC1 连网关都 ping 不通外网接口。

---

## 四、 验证

*   PC1 ping Server1 (202.100.1.2)。
*   **通了**。
*   反过来，Server1 ping PC1。
*   **不通**。为什么？因为我们只配了 Trust -> Untrust 的放行，没配反向的。这就是防火墙的安全性：**有去无回**（除非有状态检测表项，但主动发起的不行）。
