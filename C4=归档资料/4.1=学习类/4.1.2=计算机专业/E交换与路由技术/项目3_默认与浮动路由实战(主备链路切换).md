# 项目3实战：默认路由与浮动路由 (备份链路)

> **实验目标**：理解“默认路由”简化配置的作用，并实现当主链路故障时，备份链路自动接管的效果。
> **场景模拟**：公司有两条出口线路。平时走 1000M 的宽带，断了之后自动切到 100M 的备用宽带。

---

## 一、 概念大白话

### 1. 默认路由 (Default Route)
*   **写法**：`0.0.0.0 0.0.0.0`
*   **含义**：代表“所有我不认识的目的地”。
*   **用途**：通常用于公司连接外网（互联网）。因为互联网有无数个网段，你不可能一一配置，所以统统丢给“默认路由”。

### 2. 浮动路由 (Floating Route)
*   **核心参数**：优先级 (Preference)。
*   **原理**：
    *   华为路由器默认静态路由优先级是 **60**。
    *   如果我们配一条优先级为 **100** 的路由，它平时会“潜伏”在底层（不生效）。
    *   只有当优先级为 60 的主路由“消失”（断线）时，它才会“浮上来”生效。

---

## 二、 准备工作 (改动拓扑)

1. **加一根线**：
   * 在 eNSP 中，再拿一根 `Copper` 线。
   * 连接 **R1** 的 `GE 0/0/2`  到  **R2** 的 `GE 0/0/2`。
   * *(这就是我们的备份线路)*

2. **配置备用接口 IP**：
```shell
# R1
[R1] interface g0/0/2
[R1-g0/0/2] ip address 121.1.1.1 24

# R2
[R2] interface g0/0/2
[R2-g0/0/2] ip address 121.1.1.2 24
```
> **检查**：此时 R1 应该能 Ping 通 `121.1.1.2`。

---

## 三、 配置浮动路由

我们现在让 R1 去 R2 变成双保险。

### 1. 配置主路由 (优先级默认60)
```shell
[R1] ip route-static 0.0.0.0 0 12.1.1.2
```

### 2. 配置备路由 (设置优先级为100)
```shell
[R1] ip route-static 0.0.0.0 0 121.1.1.2 preference 100
```

---

## 四、 见证奇迹 (测试切换)

### 步骤1：查看当前路由表
在 R1 输入：`display ip routing-table`
* **结果**：你应该只能看到 `0.0.0.0` 走的是 `12.1.1.2` (GE 0/0/0)。那条优先级 100 的路由是看不见的。

### 步骤2：模拟断网
手动把 R1 的主接口关掉：
```shell
[R1] interface GigabitEthernet 0/0/0
[R1-GigabitEthernet0/0/0] shutdown
```

### 步骤3：再次查看路由表
立刻再次输入：`display ip routing-table`
* **结果**：你会惊讶地发现，`0.0.0.0` 的下一跳自动变成了 `121.1.1.2` (GE 0/0/2)！
* **结论**：备份线路成功“浮动”上来了。

### 步骤4：恢复主线
```shell
[R1] interface GigabitEthernet 0/0/0
[R1-GigabitEthernet0/0/0] undo shutdown
```
* **结果**：主路由会自动抢回统治权，备份路由再次“下沉”。

---

## 五、 总结 (笔记)
*   默认路由简化了去往未知网络的配置。
*   浮动路由通过修改 **Preference (优先级)** 实现。数值越小越优先（默认60）。
*   这是保证公司网络“不掉线”的重要手段。
