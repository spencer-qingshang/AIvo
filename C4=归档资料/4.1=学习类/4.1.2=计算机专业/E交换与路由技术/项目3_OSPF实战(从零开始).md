# 项目3实战：OSPF动态路由 (真正从零开始·详解版)

> **实验目标**：从一张白纸开始，搭建三路由器网络，让北京PC和广州PC自动互通。

---

## 【新手知识补丁：我刚才敲的是什么？】

*   **`ip address 192.168.10.254 24`**：
    *   给路由器的接口（大门）配置门牌号。
    *   `24` 是子网掩码，定义了网段的大小。没有它，路由器不知道自己属于哪个“社区”。
*   **`undo shutdown`**：
    *   **合上电闸**。华为设备有些接口默认是关闭的，不敲这行，接口灯不亮，数据进不来。
*   **`ospf 1 router-id 1.1.1.1`**：
    *   启动 OSPF 进程，并给自己取个**唯一的代号**（ID）。就像在群聊里设置自己的昵称，不能重复。
*   **`area 0`**：
    *   **进入 0 号办公室**。OSPF 划分区域管理，0 是核心办公区，新手实验通常都在这里做。
*   **`network 192.168.10.0 0.0.0.255`**：
    *   **发公告**。
    *   `192.168.10.0`：代表整个 10 街道（网段）。
    *   `0.0.0.255`：反掩码。`0` 代表必须一样，`255` 代表无所谓。合起来的意思是：“所有以 192.168.10 开头的接口，都开启自动导航模式！”

---

## 第一阶段：物理连接 (地基)
1. **摆放设备**：R1, R2, R3 (AR2220); PC1, PC2。
2. **手动连线**：PC1-R1(G0/0/1), R1(G0/0/0)-R2(G0/0/0), R2(G0/0/1)-R3(G0/0/0), R3(G0/0/1)-PC2。
3. **启动所有设备**。

---

## 第二阶段：配置基础IP (必须先做，否则OSPF不工作)

### 1. 配置 PC (记得点应用)
*   PC1: IP 192.168.10.1, Mask 255.255.255.0, GW 192.168.10.254
*   PC2: IP 192.168.20.1, Mask 255.255.255.0, GW 192.168.20.254

### 2. 配置路由器接口
```shell
# R1
[R1] interface g0/0/1
[R1-g0/0/1] ip address 192.168.10.254 24
[R1-g0/0/1] undo shutdown
[R1-g0/0/1] interface g0/0/0
[R1-g0/0/0] ip address 12.1.1.1 24
[R1-g0/0/0] undo shutdown

# R2 (中间人)
[R2] interface g0/0/0
[R2-g0/0/0] ip address 12.1.1.2 24
[R2-g0/0/0] undo shutdown
[R2-g0/0/0] interface g0/0/1
[R2-g0/0/1] ip address 23.1.1.2 24
[R2-g0/0/1] undo shutdown

# R3
[R3] interface g0/0/0
[R3-g0/0/0] ip address 23.1.1.3 24
[R3-g0/0/0] undo shutdown
[R3-g0/0/0] interface g0/0/1
[R3-g0/0/1] ip address 192.168.20.254 24
[R3-g0/0/1] undo shutdown
```

---

## 第三阶段：配置 OSPF (自动导航)

```shell
# R1 配置
[R1] ospf 1 router-id 1.1.1.1
[R1-ospf-1] area 0
[R1-ospf-1-area-0.0.0.0] network 192.168.10.0 0.0.0.255
[R1-ospf-1-area-0.0.0.0] network 12.1.1.0 0.0.0.255

# R2 配置
[R2] ospf 1 router-id 2.2.2.2
[R2-ospf-1] area 0
[R2-ospf-1-area-0.0.0.0] network 12.1.1.0 0.0.0.255
[R2-ospf-1-area-0.0.0.0] network 23.1.1.0 0.0.0.255

# R3 配置
[R3] ospf 1 router-id 3.3.3.3
[R3-ospf-1] area 0
[R3-ospf-1-area-0.0.0.0] network 23.1.1.0 0.0.0.255
[R3-ospf-1-area-0.0.0.0] network 192.168.20.0 0.0.0.255
```

---

## 第四阶段：验证结果
1. **查看邻居**：`display ospf peer brief` (状态需为 Full)。
2. **查看路由表**：`display ip routing-table protocol ospf` (需看到对端网段)。
3. **最终测试**：PC1 Ping PC2 (192.168.20.1)。
