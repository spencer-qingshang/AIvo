# 项目3：运用路由器构建中型园区网络 (概念详解版)

## 一、 核心学习路径
本章节是网络技术的分水岭。交换机管“局域网内部”通信，而路由器管“跨网段”通信。没有路由，你就上不了互联网。

学习顺序建议：
1.  **DHCP**：先解决“自动给电脑分IP”的问题。
2.  **单臂路由**：解决“不同部门（VLAN）之间怎么打电话”的问题。
3.  **静态路由**：手动告诉路由器路怎么走（适合小路）。
4.  **动态路由 (OSPF)**：路由器自己交流路况（适合大路）。

---

## 二、 知识点大白话解析

### 1. 路由器 (Router) 的本质
*   **别名**：网关 (Gateway)。
*   **作用**：它是不同网络之间的“翻译官”和“向导”。
*   **路由表 (Routing Table)**：路由器的“地图”。它不会像交换机那样广播找人，它只看地图。如果地图上没有去往目的地的路，它就会直接把数据包丢掉。

### 2. DHCP (动态主机配置协议)
*   **痛点**：公司有1000台电脑，一台台手动配IP会累死人。
*   **解决方案**：路由器的DHCP功能就像一个“发号员”。电脑一开机，就问路由器要一个IP，路由器从“地址池”里拿一个没用的分给它。
*   **两种模式**：
    *   **接口模式**：就近原则，这个接口下的电脑，就给这个接口网段的IP。
    *   **全局模式**：在大池子里统一管理，稍微复杂点，但更灵活。

### 3. 单臂路由 (Router-on-a-Stick)
*   **场景**：交换机上划分了销售部(VLAN 10)和财务部(VLAN 20)。虽然连在同一台交换机上，但因为VLAN隔离，他们就像在两个平行世界，没法通信。
*   **原理**：路由器就像一个“中转站”。
    1.  路由器只需要**一根线**连到交换机。
    2.  但这根线被逻辑上切成了很多个“**子接口**”（虚拟接口）。
    3.  子接口1.10 负责接销售部的电话，子接口1.20 负责接财务部的电话。
    4.  路由器在中间把话传过去，实现互通。

### 4. 静态路由 vs 动态路由
这是本章最核心的内容。假设你要从北京去上海：

| 类型 | 名称 | 比喻 | 优缺点 | 适用场景 |
| :--- | :--- | :--- | :--- | :--- |
| **静态路由** | Static Route | **纸质地图/指路牌** | **优点**：精准，不占路由器脑子。<br>**缺点**：路断了它不知道，还得人工去改配置。 | 小型网络，只有两三台路由器时。 |
| **默认路由** | Default Route | **路标“其他所有方向”** | 只要不知道路怎么走，统统往这个方向扔。 | 也就是所谓的“缺省路由”，通常指向出口（互联网）。 |
| **动态路由** | OSPF / RIP | **高德/百度导航** | **优点**：实时路况，路断了自动换路。<br>**缺点**：路由器要一直不停地跟邻居聊天换信息，比较累（占CPU）。 | 中大型网络，路由器很多的时候。 |

---

## 三、 关键命令速查 (字典)

### 1. DHCP配置 (接口模式)
```shell
dhcp enable                          # 全局开启DHCP总开关
interface g0/0/0                     # 进入接口
 dhcp select interface               # 开启接口模式
 dhcp server dns-list 114.114.114.114 # 发给电脑的DNS
```

### 2. 单臂路由配置
```shell
interface g0/0/0.10                  # 创建子接口 .10
 dot1q termination vid 10            # 绑定 VLAN 10
 ip address 192.168.10.1 24          # 配置网关IP
 arp broadcast enable                # 开启ARP广播 (新手最容易忘！)
```

### 3. 静态路由配置
```shell
# 格式：ip route-static [目标网段] [掩码] [下一跳IP]
ip route-static 192.168.2.0 24 10.0.0.2
```
> **人话解释**：路由器R1，如果你要去 `192.168.2.0` 这个地方，请把包交给 `10.0.0.2` (R2的接口)。

### 4. OSPF配置 (动态)
```shell
ospf 1 router-id 1.1.1.1             # 启动OSPF进程，给自己起个名
 area 0                              # 进入区域0 (骨干区域)
  network 192.168.1.0 0.0.0.255      # 宣告：我有这些网段，加入OSPF大家庭
```

---

## 四、 常见面试/考试题
1.  **问**：为什么配置了单臂路由还是通不了？
    *   **答**：检查子接口下有没有敲 `arp broadcast enable`？交换机连接路由器的口是不是配置了 `Trunk`？
2.  **问**：静态路由下一跳地址写谁？
    *   **答**：写**直接相连**的那台路由器的**接口IP**。
