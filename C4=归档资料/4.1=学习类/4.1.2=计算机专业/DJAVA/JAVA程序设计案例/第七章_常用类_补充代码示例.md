# 第七章：常用类 - 补充代码示例

---

### 1. `Object` 类的 `toString()` 和 `equals()` 示例

所有类都默认继承 `Object`，重写这两个方法是Java编程的基本功。

```java
import java.util.Objects;

class Person {
    private String idCard; // 假设身份证号是唯一标识
    private String name;

    public Person(String idCard, String name) {
        this.idCard = idCard;
        this.name = name;
    }

    // 1. 重写 toString() 方法
    // 如果不重写，打印对象会得到类似 "Person@1b6d3586" 的地址信息
    @Override
    public String toString() {
        return "Person{id='" + idCard + "', name='" + name + "'}";
    }

    // 2. 重写 equals() 方法
    // 如果不重写，equals的行为和 == 一样，比较的是内存地址
    @Override
    public boolean equals(Object o) {
        // (1) 如果是同一个对象，肯定相等
        if (this == o) return true;
        // (2) 如果对象是null或者类型不同，肯定不相等
        if (o == null || getClass() != o.getClass()) return false;
        // (3) 向下转型，以便访问子类属性
        Person person = (Person) o;
        // (4) 比较核心内容（这里是身份证号）是否相同
        return Objects.equals(this.idCard, person.idCard);
    }
}

public class ObjectExample {
    public static void main(String[] args) {
        Person p1 = new Person("123", "张三");
        Person p2 = new Person("123", "张三"); // 内容相同，但地址不同
        Person p3 = new Person("456", "李四");

        // 测试 toString()
        System.out.println("p1对象的信息: " + p1.toString()); // 输出: Person{id='123', name='张三'}
        
        // 测试 equals()
        System.out.println("p1 和 p2 是否相等: " + p1.equals(p2)); // 输出: true (因为重写后比较的是idCard)
        System.out.println("p1 和 p3 是否相等: " + p1.equals(p3)); // 输出: false
        
        // 对比 == 
        System.out.println("p1 == p2 ? " + (p1 == p2)); // 输出: false (因为是两个不同的new对象，地址不同)
    }
}
```

---

### 2. `String` (不可变) vs `StringBuffer` (可变) 示例

#### `String` 类的常用方法

`String` 的核心是不可变性，但它提供了大量方法来“创建”新字符串。

```java
public class StringMethodsExample {
    public static void main(String[] args) {
        String text = "  Java is Fun!  ";

        // 1. 获取长度: .length()
        System.out.println("长度: " + text.length());

        // 2. 去除首尾空格: .trim()
        String trimmedText = text.trim();
        System.out.println("去除空格后: '" + trimmedText + "'");

        // 3. 转换为大写/小写: .toUpperCase() / .toLowerCase()
        System.out.println("转为大写: " + trimmedText.toUpperCase());
        System.out.println("转为小写: " + trimmedText.toLowerCase());

        // 4. 判断是否包含/开头/结尾: .contains(), .startsWith(), .endsWith()
        System.out.println("是否包含 'Fun': " + trimmedText.contains("Fun"));
        System.out.println("是否以 'Java' 开头: " + trimmedText.startsWith("Java"));

        // 5. 查找字符/字符串索引: .indexOf(), .lastIndexOf()
        System.out.println("'a' 第一次出现的位置: " + trimmedText.indexOf('a')); // 从左往右找
        System.out.println("'a' 最后一次出现的位置: " + trimmedText.lastIndexOf('a')); // 从右往左找

        // 6. 截取子字符串: .substring()
        String sub = trimmedText.substring(5, 7); // 从索引5开始，到索引7结束（不包含7）
        System.out.println("截取[5,7)的子串: '" + sub + "'"); // 输出 'is'

        // 7. 替换字符/字符串: .replace()
        String replacedText = trimmedText.replace("Fun", "Awesome");
        System.out.println("替换后: " + replacedText);

        // 8. 分割字符串: .split()
        String data = "张三,李四,王五";
        String[] names = data.split(",");
        System.out.println("分割后的名字数组:");
        for (String name : names) {
            System.out.println("- " + name);
        }
    }
}
```

#### `StringBuffer` 的可变操作

`StringBuffer` 用于频繁修改字符串的场景，以提高性能。

```java
public class StringBufferMethodsExample {
    public static void main(String[] args) {
        StringBuffer sb = new StringBuffer("I Love ");
        
        // 1. 追加: .append()
        sb.append("Java");
        System.out.println("Append后: " + sb);

        // 2. 插入: .insert()
        sb.insert(2, "Really "); // 在索引为2的位置插入
        System.out.println("Insert后: " + sb);

        // 3. 删除: .delete()
        sb.delete(2, 9); // 删除从索引2到9的字符（不包含9）
        System.out.println("Delete后: " + sb);

        // 4. 替换: .replace()
        sb.replace(7, 11, "Python"); // 将索引7到11的替换为 "Python"
        System.out.println("Replace后: " + sb);

        // 5. 反转: .reverse()
        sb.reverse();
        System.out.println("Reverse后: " + sb);
    }
}
```

---

### 3. 随机数生成示例 (`Math.random()` vs `Random` 类)

两者都能生成随机数，但 `Random` 类更灵活。

```java
import java.util.Random;

public class RandomExample {
    public static void main(String[] args) {
        // --- 使用 Math.random() ---
        // 目标：生成一个 [1, 6] 之间的整数（模拟掷骰子）
        // Math.random() 生成 [0.0, 1.0) 的double
        // * 6 -> [0.0, 6.0)
        // + 1 -> [1.0, 7.0)
        // (int) -> 1, 2, 3, 4, 5, 6
        int diceRoll = (int)(Math.random() * 6 + 1);
        System.out.println("Math.random() 掷骰子: " + diceRoll);
        
        // --- 使用 Random 类 ---
        Random random = new Random();
        
        // 目标：生成一个 [1, 6] 之间的整数
        // random.nextInt(6) 生成 [0, 5] 的整数
        // + 1 -> [1, 6]
        int diceRoll2 = random.nextInt(6) + 1;
        System.out.println("Random 类掷骰子: " + diceRoll2);
    }
}
```

---

### 4. 基本类型包装类示例 (装箱、拆箱、类型转换)

包装类让基本类型拥有了对象的能力，是集合框架的基础。

```java
import java.util.ArrayList;
import java.util.List;

public class WrapperExample {
    public static void main(String[] args) {
        // --- 自动装箱与自动拆箱 ---
        int primitiveInt = 10;
        Integer wrapperInt = primitiveInt; // 自动装箱
        System.out.println("包装类对象: " + wrapperInt);
        
        int unboxedInt = wrapperInt; // 自动拆箱
        System.out.println("拆箱后的基本类型: " + unboxedInt);
        
        // 包装类的主要用途：存入集合
        List<Integer> list = new ArrayList<>();
        list.add(100); // 自动装箱
        // list.add("hello"); // 编译错误，因为泛型<Integer>约束了类型
        
        // --- 字符串与基本类型转换 (非常常用) ---
        // 1. 字符串 -> 基本类型
        String numberStr = "123";
        int num = Integer.parseInt(numberStr);
        System.out.println("从字符串解析出的整数: " + (num + 1)); // 输出 124，证明是数字
        
        // 2. 基本类型 -> 字符串
        int anotherNum = 456;
        String str1 = anotherNum + ""; // 最简单的方式
        String str2 = String.valueOf(anotherNum); // 最专业的方式
        System.out.println("转换为字符串: " + str1);
    }
}
```

---

### 5. 日期时间类示例 (`Date`, `Calendar` 和 `SimpleDateFormat`)

`Date` 用于表示时间点，`Calendar` 用于操作时间，而 `SimpleDateFormat` 用于格式化和解析时间。

#### `Date` 和 `Calendar` 的基本操作

```java
import java.util.Calendar;
import java.util.Date;

public class DateTimeExample {
    public static void main(String[] args) {
        // --- Calendar 类：获取和设置日期的特定部分 ---
        Calendar cal = Calendar.getInstance(); // 获取代表当前时间的日历对象
        
        // 1. 获取字段
        int year = cal.get(Calendar.YEAR);
        int month = cal.get(Calendar.MONTH) + 1; // 月份从0开始，所以要+1
        int day = cal.get(Calendar.DAY_OF_MONTH);
        System.out.println("当前日期: " + year + "-" + month + "-" + day);
        
        // 2. 设置字段
        cal.set(Calendar.YEAR, 2025); 
        cal.set(Calendar.MONTH, 0); // 设置为1月 (0是一月)
        
        // 3. 增减时间: .add()
        System.out.println("设置到2025年1月: " + cal.getTime());
        cal.add(Calendar.MONTH, 2); // 增加2个月
        System.out.println("增加2个月后: " + cal.getTime());
        cal.add(Calendar.DAY_OF_MONTH, -10); // 减去10天
        System.out.println("再减去10天后: " + cal.getTime());
    }
}
```

#### `SimpleDateFormat` 的格式化与解析 (非常常用)

`SimpleDateFormat` 可以在 `Date` 对象和 `String` 文本之间进行转换。

```java
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;

public class SimpleDateFormatExample {
    public static void main(String[] args) throws ParseException {
        // --- 1. 格式化: 将 Date 对象转换为指定格式的字符串 ---
        Date now = new Date();
        // 创建格式化模板，y=年, M=月, d=日, H=24小时, h=12小时, m=分, s=秒
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        String formattedDate = sdf.format(now);
        System.out.println("格式化后的日期字符串: " + formattedDate);

        // --- 2. 解析: 将符合格式的字符串转换为 Date 对象 ---
        String dateString = "2024-01-01 10:30:00";
        // 注意：SimpleDateFormat的模板必须和字符串的格式完全匹配
        Date parsedDate = sdf.parse(dateString);
        System.out.println("从字符串解析出的Date对象: " + parsedDate);
    }
}
```
